# VeterinÃ¡rnÃ­ rezervaÄnÃ­ systÃ©m - Cursor Rules

## ğŸš¨ DÅ®LEÅ½ITÃ‰: Node.js verze

**PÅ˜ED KAÅ½DÃM SPUÅ TÄšNÃM JAVASCRIPT/Node.js PÅ˜ÃKAZÅ® MUSÃTE:**

```bash
source ~/.nvm/nvm.sh
```

**DÅ¯vod:** SystÃ©m mÃ¡ starou verzi Node.js v16.20.2, ale projekt potÅ™ebuje novÄ›jÅ¡Ã­ verzi v22.16.0 z NVM.

## ğŸ“ Struktura projektu

- **Backend API:** `apps/api/` - Express.js server s Prisma ORM
- **Frontend:** `apps/web/` - Next.js aplikace
- **DatabÃ¡ze:** `prisma/` - Prisma schema a migrace (vÅ¾dy v root, ne v apps/web/prisma!)

## ğŸ”§ KlÃ­ÄovÃ© pÅ™Ã­kazy

### DatabÃ¡ze
```bash
# VÅ¾dy nejdÅ™Ã­ve naÄÃ­st NVM
source ~/.nvm/nvm.sh

# Prisma pÅ™Ã­kazy (vÅ¾dy z root adresÃ¡Å™e)
npx prisma generate
npx prisma migrate dev --name nazev_migrace
npx tsx prisma/seed.ts  # DÅ®LEÅ½ITÃ‰: PouÅ¾Ã­t tsx, ne npx prisma db seed
```

### Development
```bash
# Backend
cd apps/api && npm run dev

# Frontend  
cd apps/web && npm run dev
```

## ğŸŒ Timezone handling

Projekt pouÅ¾Ã­vÃ¡ tenant-aware timezone handling:
- KaÅ¾dÃ½ tenant mÃ¡ vlastnÃ­ timezone (default: Europe/Prague)
- PostgreSQL pouÅ¾Ã­vÃ¡ TIMESTAMPTZ
- API pouÅ¾Ã­vÃ¡ `parseTimezoneDateTime()` a `formatTimezoneDateTime()`
- Frontend automaticky naÄte tenant timezone

## ğŸ”’ BezpeÄnost

- Rate limiting na API endpointy
- JWT autentizace s role-based pÅ™Ã­stupem
- XSS ochrana v validaci
- HTTPS enforcement v produkci

## ğŸ“§ Notifikace

- Email notifikace pÅ™es NotificationService
- Podporuje fallback na tenant default email/phone
- AutomatickÃ© pÅ™ipomÃ­nky rezervacÃ­

## ğŸš€ Deployment

- **API:** Railway (PostgreSQL + Node.js)
- **Frontend:** Vercel
- **DomÃ©ny:** AutomatickÃ© SSL certifikÃ¡ty

## ğŸ› Debug

- Debug logy pouze v development reÅ¾imu
- PouÅ¾Ã­vat `process.env.NODE_ENV === 'development'` pro podmÃ­nÄ›nÃ© logovÃ¡nÃ­
- Railway connection testy skryty v produkci

## ğŸ“ TelefonnÃ­ validace

RobustnÃ­ validace ÄeskÃ½ch a mezinÃ¡rodnÃ­ch ÄÃ­sel:
- ÄŒeskÃ©: 777123456, 0777123456, +420777123456
- MezinÃ¡rodnÃ­: +49123456789
- SpecifickÃ© chybovÃ© zprÃ¡vy pro rÅ¯znÃ© problÃ©my

## ğŸ”„ Workflow

1. VÅ¾dy naÄÃ­st NVM: `source ~/.nvm/nvm.sh`
2. Prisma operace z root adresÃ¡Å™e
3. Seed pÅ™es `npx tsx prisma/seed.ts`
4. Testovat validace telefonnÃ­ch ÄÃ­sel
5. Commit s popisnou zprÃ¡vou
6. Push na GitHub â†’ automatickÃ½ deployment

## ğŸ“š Dokumentace

- `RESERVATION-MANAGEMENT-ANALYSIS.md` - AnalÃ½za systÃ©mu rezervacÃ­
- `RESERVATION-TECHNICAL-SPECS.md` - TechnickÃ¡ specifikace
- `SECURITY-CHECKLIST.md` - BezpeÄnostnÃ­ audit
- `TIMEZONE-REFACTOR-SUMMARY.md` - Timezone implementace 